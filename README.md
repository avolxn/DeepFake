# DeepFake: Система распознавания поддельных изображений лиц

## Описание проекта

Проект DeepFake представляет собой систему для распознавания поддельных (синтетических) изображений лиц. Основная цель проекта - обучить модель, которая может определить, являются ли два изображения лица одного и того же человека подлинными или одно из них является синтетическим (DeepFake).

## Основные компоненты проекта

1. **Подготовка данных** - создание пар изображений, разделение на выборки, применение трансформаций.
2. **Обучение модели** - загрузка предобученной модели, тонкая настройка, сохранение весов.
3. **Инференс** - предсказание схожести между парами изображений.
4. **Оценка модели** - вычисление метрики Equal Error Rate (EER).

## Структура репозитория

- **`data/`** – данные проекта.
- **`notebooks/`** – Jupyter ноутбуки с экспериментами и анализом.
- **`src/`** – основной код проекта:
  - `preprocessing.py` - подготовка данных
  - `train_model.py` - обучение модели
  - `inference.py` - инференс модели
  - `feature_engineering.py` - оценка модели
  - `utils.py` - вспомогательные функции
- **`experiments/`** - результаты экспериментов.

## Как использовать модель

### 1. Установка зависимостей

```bash
pip install -r requirements.txt
```

### 2. Настройка токена Hugging Face

Для загрузки предобученной модели необходим токен Hugging Face. Установите его как переменную окружения:

```bash
# Linux/macOS
export HF_TOKEN="ваш_токен_hugging_face"

# Windows (PowerShell)
$env:HF_TOKEN="ваш_токен_hugging_face"

# Windows (CMD)
set HF_TOKEN=ваш_токен_hugging_face
```

### 3. Обучение модели

```bash
python -m src.train_model
```

### 4. Инференс (использование модели для предсказаний)

```bash
python -m src.inference --test_path путь/к/тестовым/данным.csv --output_path путь/для/сохранения/результатов.csv
```

### 5. Оценка модели

```bash
python -m src.feature_engineering --public_test_url путь/к/публичному/тесту.csv --public_prediction_url путь/к/предсказаниям.csv
```

## Инструкция по развертыванию с использованием Docker

```bash
# Клонирование репозитория
git clone https://github.com/avolxn/DeepFake
cd DeepFake

# Сборка Docker-образа
docker build . -t deepfake:latest

# Запуск контейнера
docker run -it deepfake:latest
```

## Лицензия

Проект лицензирован под **MIT License**. Подробности см. в файле **[LICENSE](LICENSE)**.

---
